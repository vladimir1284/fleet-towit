import{s as Qe,C as Se,I as fe,J as ce,h as de,d as ie,j as pe,R as je,i as ze,v as we,M as X,z as Le,N as $e,E as Ve,L as et,D as Ce,O as Y,a2 as E,a3 as Te,t as De}from"./scheduler.RAkbNlF_.js";import{t as Ne,g as tt}from"./bundle-mjs.MFJMrG53.js";import{S as rt,i as nt}from"./index.5brJxJeu.js";import{j as ge,k as at}from"./singletons.LsHtuZJq.js";import{p as ue,n as it}from"./stores.qfWq5sye.js";import{d as se,w as B}from"./index.XGR6uEzK.js";import{p as st,s as ot}from"./stringify.ZBF_Z-nX.js";const ut=!0,He=ut;function lt(e){let t,r,a,i,o,n,u,l=[{xmlns:"http://www.w3.org/2000/svg"},{fill:"currentColor"},e[4],{class:o=Ne("shrink-0",e[3][e[0]],e[5].class)},{role:e[1]},{"aria-label":e[2]},{viewBox:"0 0 20 16"}],m={};for(let h=0;h<l.length;h+=1)m=Se(m,l[h]);return{c(){t=fe("svg"),r=fe("g"),a=fe("path"),i=fe("path"),this.h()},l(h){t=ce(h,"svg",{xmlns:!0,fill:!0,class:!0,role:!0,"aria-label":!0,viewBox:!0});var v=de(t);r=ce(v,"g",{fill:!0});var c=de(r);a=ce(c,"path",{d:!0}),de(a).forEach(ie),i=ce(c,"path",{d:!0}),de(i).forEach(ie),c.forEach(ie),v.forEach(ie),this.h()},h(){pe(a,"d","m10.036 8.278 9.258-7.79A1.979 1.979 0 0 0 18 0H2A1.987 1.987 0 0 0 .641.541l9.395 7.737Z"),pe(i,"d","M11.241 9.817c-.36.275-.801.425-1.255.427-.428 0-.845-.138-1.187-.395L0 2.6V14a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V2.5l-8.759 7.317Z"),pe(r,"fill","currentColor"),je(t,m)},m(h,v){ze(h,t,v),we(t,r),we(r,a),we(r,i),n||(u=[X(t,"click",e[6]),X(t,"keydown",e[7]),X(t,"keyup",e[8]),X(t,"focus",e[9]),X(t,"blur",e[10]),X(t,"mouseenter",e[11]),X(t,"mouseleave",e[12]),X(t,"mouseover",e[13]),X(t,"mouseout",e[14])],n=!0)},p(h,[v]){je(t,m=tt(l,[{xmlns:"http://www.w3.org/2000/svg"},{fill:"currentColor"},v&16&&h[4],v&33&&o!==(o=Ne("shrink-0",h[3][h[0]],h[5].class))&&{class:o},v&2&&{role:h[1]},v&4&&{"aria-label":h[2]},{viewBox:"0 0 20 16"}]))},i:Le,o:Le,d(h){h&&ie(t),n=!1,$e(u)}}}function ft(e,t,r){const a=["size","role","ariaLabel"];let i=Ve(t,a);const o=et("iconCtx")??{},n={xs:"w-3 h-3",sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6",xl:"w-8 h-8"};let{size:u=o.size||"md"}=t,{role:l=o.role||"img"}=t,{ariaLabel:m="envelope solid"}=t;function h(f){Y.call(this,e,f)}function v(f){Y.call(this,e,f)}function c(f){Y.call(this,e,f)}function b(f){Y.call(this,e,f)}function p(f){Y.call(this,e,f)}function R(f){Y.call(this,e,f)}function I(f){Y.call(this,e,f)}function T(f){Y.call(this,e,f)}function Q(f){Y.call(this,e,f)}return e.$$set=f=>{r(5,t=Se(Se({},t),Ce(f))),r(4,i=Ve(t,a)),"size"in f&&r(0,u=f.size),"role"in f&&r(1,l=f.role),"ariaLabel"in f&&r(2,m=f.ariaLabel)},t=Ce(t),[u,l,m,n,i,t,h,v,c,b,p,R,I,T,Q]}class Ut extends rt{constructor(t){super(),nt(this,t,ft,lt,Qe,{size:0,role:1,ariaLabel:2})}}const Ot=ge("invalidate"),Ze=ge("invalidate_all"),qe=ge("before_navigate"),ct=ge("after_navigate");function ye(e){return e.toString().split(/[[\].]+/).filter(t=>t)}function Be(e){return e.reduce((t,r)=>{const a=String(r);return typeof r=="number"||/^\d+$/.test(a)?t+=`[${a}]`:t?t+=`.${a}`:t+=a,t},"")}class H extends Error{constructor(t){super(t),Object.setPrototypeOf(this,H.prototype)}}function be(e,t,r){return e[t]=r,"skip"}function Me(e,t){return t.value!==void 0&&typeof t.value!="object"&&t.path.length<e.length}function Re(e,t,r={}){r.modifier||(r.modifier=i=>Me(t,i)?void 0:i.value);const a=N(e,t,r.modifier);if(a)return r.value===void 0||r.value(a.value)?a:void 0}function N(e,t,r){if(!t.length)return;const a=[t[0]];let i=e;for(;a.length<t.length;){const n=a[a.length-1],u=r?r({parent:i,key:String(n),value:i[n],path:a.map(l=>String(l)),isLeaf:!1,set:l=>be(i,n,l)}):i[n];if(u===void 0)return;i=u,a.push(t[a.length])}const o=t[t.length-1];return{parent:i,key:String(o),value:i[o],path:t.map(n=>String(n)),isLeaf:!0,set:n=>be(i,o,n)}}function x(e,t,r=[]){for(const a in e){const i=e[a],o=i===null||typeof i!="object",n={parent:e,key:a,value:i,path:r.map(String).concat([a]),isLeaf:o,set:l=>be(e,a,l)},u=t(n);if(u==="abort")return u;if(u==="skip")continue;if(!o){const l=x(i,t,n.path);if(l==="abort")return l}}}async function dt(e,t,r=[]){for(const a in e){const i=e[a],o=i===null||typeof i!="object",n={parent:e,key:a,value:i,path:r.map(String).concat([a]),isLeaf:o,set:l=>be(e,a,l)},u=await t(n);if(u==="abort")return u;if(u==="skip")break;if(!o){const l=x(i,t,n.path);if(l==="abort")return l}}}function mt(e,t){return e===t||e.size===t.size&&[...e].every(r=>t.has(r))}function ht(e,t){const r=new Map;function a(i,o){const n=N(o,i.path);function u(){r.set(i.path.join(" "),i.path)}i.isLeaf?n?i.value!==n.value&&u():u():n&&(i.value instanceof Date&&n.value instanceof Date&&i.value.getTime()!=n.value.getTime()||i.value instanceof Set&&n.value instanceof Set&&!mt(i.value,n.value))&&u()}return x(e,i=>a(i,t)),x(t,i=>a(i,e)),Array.from(r.values())}function $(e,t,r){for(const a of t){const i=N(e,a,({parent:o,key:n,value:u})=>((u===void 0||typeof u!="object")&&(o[n]={}),o[n]));i&&(i.parent[i.key]=r)}}function _e(e,t){const r=ye(t),a=se(e,i=>N(i,r)?.value);return{subscribe(...i){const o=a.subscribe(...i);return()=>o()},update(i){e.update(o=>{const n=N(o,r,({parent:u,key:l,value:m})=>(m===void 0&&(u[l]=/\D/.test(l)?{}:[]),u[l]));return n&&(n.parent[n.key]=i(n.value)),o})},set(i){e.update(o=>{const n=N(o,r,({parent:u,key:l,value:m})=>(m===void 0&&(u[l]=/\D/.test(l)?{}:[]),u[l]));return n&&(n.parent[n.key]=i),o})}}}function G(e){if(typeof e!="object")return e;var t,r,a=Object.prototype.toString.call(e);if(a==="[object Object]"){if(e.constructor!==Object&&typeof e.constructor=="function"){r=new e.constructor;for(t in e)e.hasOwnProperty(t)&&r[t]!==e[t]&&(r[t]=G(e[t]))}else{r={};for(t in e)t==="__proto__"?Object.defineProperty(r,t,{value:G(e[t]),configurable:!0,enumerable:!0,writable:!0}):r[t]=G(e[t])}return r}if(a==="[object Array]"){for(t=e.length,r=Array(t);t--;)r[t]=G(e[t]);return r}return a==="[object Set]"?(r=new Set,e.forEach(function(i){r.add(G(i))}),r):a==="[object Map]"?(r=new Map,e.forEach(function(i,o){r.set(G(o),G(i))}),r):a==="[object Date]"?new Date(+e):a==="[object RegExp]"?(r=new RegExp(e.source,e.flags),r.lastIndex=e.lastIndex,r):a==="[object DataView]"?new e.constructor(G(e.buffer)):a==="[object ArrayBuffer]"?e.slice(0):a.slice(-6)==="Array]"?new e.constructor(e):e}function ee(e){return G(e)}function yt(e){const t=e;let r=!0,a=!1,i=!1,o=!1,n,u;for(;r;)switch(e._def.typeName){case"ZodNullable":a=!0,e=e.unwrap();break;case"ZodDefault":o=!0,u=e._def.defaultValue(),e=e._def.innerType;break;case"ZodOptional":i=!0,e=e.unwrap();break;case"ZodEffects":n||(n=e),e=e._def.schema;break;case"ZodPipeline":e=e._def.out;break;case"ZodBranded":e=e.unwrap();break;default:r=!1}return{zodType:e,originalType:t,isNullable:a,isOptional:i,hasDefault:o,defaultValue:u,effects:n}}const Ee=new WeakMap;function Fe(e){return Ee.has(e)||Ee.set(e,oe(e)),Ee.get(e)}function oe(e){const t=yt(e).zodType;if(t._def.typeName=="ZodObject")return Object.fromEntries(Object.entries(t.shape).map(([r,a])=>[r,oe(a)]).filter(r=>r[1]!==void 0));if(t._def.typeName=="ZodArray")return oe(t._def.type)??{};if(t._def.typeName=="ZodRecord")return oe(t._def.valueType)??{};if(t._def.typeName=="ZodUnion")return t._def.options.reduce((a,i)=>{const o=oe(i);return o&&(a={...a??{},...o}),a},void 0)}function ve(e,t,r=!0){const a={},i=Object.entries(e);if("_errors"in e&&e._errors.length){if(!t||!r)return e._errors;a._errors=e._errors}for(const[o,n]of i.filter(([u])=>u!=="_errors")){const u=/^\d+$/.test(o);a[o]=ve(n,t?u?t:t[o]:void 0,!!t?.[o])}return a}function bt(e){return We(e,[])}function We(e,t){return Object.entries(e).filter(([,a])=>a!==void 0).flatMap(([a,i])=>{if(Array.isArray(i)&&i.length>0){const o=t.concat([a]);return{path:Be(o),messages:i}}else return We(e[a],t.concat([a]))})}function ke(e,t){e.update(r=>(x(r,a=>{if(!(a.path.length==1&&a.path[0]=="_errors"&&!t.clearFormLevelErrors)&&Array.isArray(a.value))return a.set(void 0)}),t.undefinePath&&$(r,[t.undefinePath],void 0),r))}async function xe(e,t,r,a,i){return gt(e,t,r,a,i)}async function gt(e,t,r,a,i){let o=!0,n={};if(e)if("safeParseAsync"in e){const u=e,l=await u.safeParseAsync(t);o=l.success,l.success?t=l.data:n=ve(l.error.format(),Fe(u))}else{t={...t};for(const[m,h]of Object.entries(e))typeof h=="function"&&!(m in t)&&(t[m]=void 0);const u=e,l=[];await dt(t,async({value:m,path:h})=>{const v=h.filter(b=>/\D/.test(String(b))),c=N(u,v);if(typeof c?.value=="function"){const b=c.value;let p;if(Array.isArray(m))for(const R in m)try{p=await b(m[R]),p&&(o=!1,l.push({path:h.concat([R]),errors:typeof p=="string"?[p]:p??void 0}))}catch(I){o=!1,console.error(`Error in form validators for field "${h}":`,I)}else try{p=await b(m),p&&(o=!1,l.push({path:h,errors:typeof p=="string"?[p]:p??void 0}))}catch(R){o=!1,console.error(`Error in form validators for field "${h}":`,R)}}});for(const{path:m,errors:h}of l){const v=N(n,m,({parent:c,key:b,value:p})=>(p===void 0&&(c[b]={}),c[b]));if(v){const{parent:c,key:b}=v;c[b]=h}}}return{valid:o,posted:i,errors:n,data:t,constraints:a,message:void 0,id:r}}async function vt(e,t,r,a){if(typeof e.validators!="object"||!("safeParseAsync"in e.validators))return;const i=e.validators,o=await i.safeParseAsync(E(t));if(o.success)r.update(n=>(x(n,u=>{if(u.key=="_errors")return u.set(void 0)}),n));else{const n=ve(o.error.format(),Fe(i));r.update(u=>(x(u,l=>{if(l.key=="_errors")return l.set(void 0)}),x(n,l=>{if(l.key=="_errors"){const m=l.path.length==1?{value:!0}:a&&N(a,l.path.slice(0,-1));if(m&&m.value)return $(u,[l.path],l.value)}}),u))}}async function Ae(e,t,r,a,i,o={}){function n(){ke(a,{undefinePath:e,clearFormLevelErrors:!0})}function u(m){return typeof m=="string"&&(m=[m]),(o.update===!0||o.update=="errors")&&a.update(h=>{const v=N(h,e,c=>{if(Me(e,c))throw new H("Errors can only be added to form fields, not to arrays or objects in the schema. Path: "+c.path.slice(0,-1));return c.value===void 0?(c.parent[c.key]={},c.parent[c.key]):c.value});if(!v)throw new H("Error path could not be created: "+e);return v.parent[v.key]=m??void 0,h}),m??void 0}const l=await pt(e,t.validators,r,a,i,o);return l.validated?l.validated==="all"&&!l.errors?n():l.errors=u(l.errors):l.validated===!1&&t.defaultValidator=="clear"&&(l.errors=u(l.errors)),l}async function pt(e,t,r,a,i,o={}){o.update===void 0&&(o.update=!0),o.taint===void 0&&(o.taint=!1),typeof o.errors=="string"&&(o.errors=[o.errors]);const n={value:o.value,shouldUpdate:!0,currentData:void 0,validationPath:e.filter(c=>/\D/.test(String(c)))};async function u(){return{validated:!1,errors:void 0,data:void 0}}function l(c,b){if(b===void 0)return!1;const p=N(b,c);return p?p.value:!1}function m(c){a.update(c)}function h(){ke(a,{undefinePath:null,clearFormLevelErrors:!0})}function v(c,b){return ve(c.format(),Fe(b))}if("value"in o)o.update===!0||o.update==="value"?r.update(c=>($(c,[e],n.value),n.currentData=c),{taint:o.taint}):n.shouldUpdate=!1;else{n.currentData=E(r);const c=N(n.currentData,e);n.value=c?.value}if(typeof t!="object")return u();if("safeParseAsync"in t){n.shouldUpdate||(n.currentData=ee(n.currentData??E(r)),$(n.currentData,[e],n.value));const c=await t.safeParseAsync(n.currentData);if(c.success)return h(),{validated:!0,errors:void 0,data:c.data};{const b=v(c.error,t);if(o.update===!0||o.update=="errors"){const R=E(i);m(I=>(x(I,T=>{if(T.key=="_errors")return T.set(void 0)}),x(b,T=>{if(T.key=="_errors"&&(T.path.length==1||l(T.path.slice(0,-1),R)))return $(I,[T.path],T.value);if(Array.isArray(T.value))return l(T.path,R)&&$(I,[T.path],T.value),"skip"}),I))}const p=N(b,e);return{validated:!0,errors:o.errors??p?.value,data:void 0}}}else{const c=N(t,n.validationPath);if(!c||c.value===void 0)return u();{const b=await c.value(n.value);return{validated:!0,errors:b&&(o.errors??b),data:void 0}}}}function he(e){return at.apply_action(e)}function wt(e){const t=JSON.parse(e);return t.data&&(t.data=st(t.data)),t}function Ie(e){return HTMLElement.prototype.cloneNode.call(e)}function _t(e,t=()=>{}){const r=async({action:i,result:o,reset:n=!0,invalidateAll:u=!0})=>{o.type==="success"&&(n&&HTMLFormElement.prototype.reset.call(e),u&&await Ze()),(location.origin+location.pathname===i.origin+i.pathname||o.type==="redirect"||o.type==="error")&&he(o)};async function a(i){if((i.submitter?.hasAttribute("formmethod")?i.submitter.formMethod:Ie(e).method)!=="post")return;i.preventDefault();const n=new URL(i.submitter?.hasAttribute("formaction")?i.submitter.formAction:Ie(e).action),u=new FormData(e),l=i.submitter?.getAttribute("name");l&&u.append(l,i.submitter?.getAttribute("value")??"");const m=new AbortController;let h=!1;const c=await t({action:n,cancel:()=>h=!0,controller:m,formData:u,formElement:e,submitter:i.submitter})??r;if(h)return;let b;try{const p=await fetch(n,{method:"POST",headers:{accept:"application/json","x-sveltekit-action":"true"},cache:"no-store",body:u,signal:m.signal});b=wt(await p.text()),b.type==="error"&&(b.status=p.status)}catch(p){if(p?.name==="AbortError")return;b={type:"error",error:p}}c({action:n,formData:u,formElement:e,update:p=>r({action:n,result:b,reset:p?.reset,invalidateAll:p?.invalidateAll}),result:b})}return HTMLFormElement.prototype.addEventListener.call(e,"submit",a),{destroy(){HTMLFormElement.prototype.removeEventListener.call(e,"submit",a)}}}const Et=(e,t=0)=>{const r=e.getBoundingClientRect();return r.top>=t&&r.left>=0&&r.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&r.right<=(window.innerWidth||document.documentElement.clientWidth)},St=(e,t=1.125,r="smooth")=>{const o=e.getBoundingClientRect().top+window.pageYOffset-window.innerHeight/(2*t);window.scrollTo({left:0,top:o,behavior:r})};var C;(function(e){e[e.Idle=0]="Idle",e[e.Submitting=1]="Submitting",e[e.Delayed=2]="Delayed",e[e.Timeout=3]="Timeout"})(C||(C={}));const At=new Set;let Ue=!1;function Tt(e,t,r){let a=C.Idle,i,o,n=!1;const u=At;function l(){m(),v(a!=C.Delayed?C.Submitting:C.Delayed),i=window.setTimeout(()=>{i&&a==C.Submitting&&v(C.Delayed)},r.delayMs),o=window.setTimeout(()=>{o&&a==C.Delayed&&v(C.Timeout)},r.timeoutMs),u.add(m)}function m(){clearTimeout(i),clearTimeout(o),i=o=0,u.delete(m),v(C.Idle)}function h(){u.forEach(f=>f()),u.clear()}function v(f){a=f,t.submitting.set(a>=C.Submitting),t.delayed.set(a>=C.Delayed),t.timeout.set(a>=C.Timeout)}const c=e;function b(f){const P=f.target;r.selectErrorText&&P.select()}function p(){r.selectErrorText&&c.querySelectorAll("input").forEach(f=>{f.addEventListener("invalid",b)})}function R(){r.selectErrorText&&c.querySelectorAll("input").forEach(f=>f.removeEventListener("invalid",b))}const I=e;function T(f){return typeof r.autoFocusOnError=="boolean"?r.autoFocusOnError:!/iPhone|iPad|iPod|Android/i.test(f)}const Q=async()=>{if(r.scrollToError=="off")return;const f=r.errorSelector;if(!f)return;await De();let P;if(P=I.querySelector(f),!P)return;P=P.querySelector(f)??P;const J=r.stickyNavbar?document.querySelector(r.stickyNavbar):null;if(typeof r.scrollToError!="string"?P.scrollIntoView(r.scrollToError):Et(P,J?.offsetHeight??0)||St(P,void 0,r.scrollToError),!T(navigator.userAgent))return;let U;if(U=P,["INPUT","SELECT","BUTTON","TEXTAREA"].includes(U.tagName)||(U=U.querySelector('input:not([type="hidden"]):not(.flatpickr-input), select, textarea')),U)try{U.focus({preventScroll:!0}),r.selectErrorText&&U.tagName=="INPUT"&&U.select()}catch{}};{p();const f=(P,J=!1)=>{m(),P||setTimeout(Q),J&&!n&&h()};return Te(()=>{R(),f(!0)}),Ue||(qe(()=>{n=!0}),ct(P=>{P.type!="enter"&&(n=!1,h())}),Ue=!0),{submitting:()=>{n=!1,l()},completed:f,scrollToFirstError:()=>{setTimeout(Q)},isSubmitting:()=>a===C.Submitting||a===C.Delayed}}}function Oe(e){!e.flashMessage||!He||Pe(e)&&(document.cookie=`flash=; Max-Age=0; Path=${e.flashMessage.cookiePath??"/"};`)}function Pe(e){return!e.flashMessage||!He?!1:e.syncFlashMessage}const Je="noCustomValidity";function Ke(e,t){const r=t&&t.length?t.join(`
`):"";e.setCustomValidity(r),r&&e.reportValidity()}function Mt(e,t){for(const r of e.querySelectorAll("input,select,textarea,button")){if(Je in r.dataset)continue;const a=N(t,ye(r.name));if(Ke(r,a?.value),a?.value)return}}function Ft(e,t,r,a,i,o,n,u,l,m,h,v,c,b,p,R,I){m();const T=i;async function Q(g,L,A){n.customValidity&&n.validationMethod!="submit-only"&&("setCustomValidity"in g&&g.setCustomValidity(""),!(L=="input"&&n.validationMethod=="onblur")&&(Je in g.dataset||Ke(g,A)))}async function f(g,L,A){if(n.validationMethod=="submit-only")return;const M=await Ae(g,n,u,T,b);if(M.data&&A&&u.set(M.data),n.customValidity){const O=CSS.escape(Be(g)),Z=e.querySelector(`[name="${O}"]`);Z&&Q(Z,L,M.errors)}}const P=["checkbox","radio","range"];function J(g){return g&&(g instanceof HTMLSelectElement||g instanceof HTMLInputElement&&P.includes(g.type))}async function U(g){if(n.validationMethod=="oninput"||n.validationMethod=="submit-only")return;const L=J(g.target);L&&await new Promise(O=>setTimeout(O,0));const A=E(p);if(!A.length)return;const M=g.target instanceof HTMLElement?g.target:null;for(const O of A)f(O,"blur",L?null:M);p.set([])}async function ne(g){if(n.validationMethod=="onblur"||n.validationMethod=="submit-only")return;const L=J(g.target);L&&await new Promise(O=>setTimeout(O,0));const A=E(p);if(!A.length)return;const M=g.target instanceof HTMLElement?g.target:null;for(const O of A){const Z=L||N(E(T),O);(L||typeof Z=="object"&&Z.key in Z.parent)&&setTimeout(()=>f(O,"input",L?M:null),0)}}e.addEventListener("focusout",U),e.addEventListener("input",ne),Te(()=>{e.removeEventListener("focusout",U),e.removeEventListener("input",ne)});const q=Tt(e,{submitting:t,delayed:r,timeout:a},n);let W;return _t(e,async g=>{const L=g.cancel;let A=!1;function M(D=!0){return A=!0,D&&q.isSubmitting()&&q.completed(!0),L()}if(g.cancel=M,q.isSubmitting()&&n.multipleSubmits=="prevent")M(!1);else{q.isSubmitting()&&n.multipleSubmits=="abort"&&W&&W.abort(),q.submitting(),W=g.controller;for(const D of h.onSubmit)await D(g)}if(A)n.flashMessage&&Oe(n);else{const D=!n.SPA&&(e.noValidate||(g.submitter instanceof HTMLButtonElement||g.submitter instanceof HTMLInputElement)&&g.submitter.formNoValidate),_=await xe(D?void 0:n.validators,E(u),E(v),E(c),E(I));if(!_.valid){M(!1);const F={type:"failure",status:(typeof n.SPA=="boolean"?void 0:n.SPA?.failStatus)??400,data:{form:_}};setTimeout(()=>Z({result:F}),0)}if(!A){switch(n.clearOnSubmit){case"errors-and-message":T.clear(),l.set(void 0);break;case"errors":T.clear();break;case"message":l.set(void 0);break}n.flashMessage&&(n.clearOnSubmit=="errors-and-message"||n.clearOnSubmit=="message")&&Pe(n)&&n.flashMessage.module.getFlash(ue).set(void 0);const F="formData"in g?g.formData:g.data;if(n.SPA){M(!1);const V={..._,posted:!0},k={type:V.valid?"success":"failure",status:V.valid?200:typeof n.SPA=="object"?n.SPA?.failStatus:400,data:{form:V}};setTimeout(()=>Z({result:k}),0)}else if(n.dataType==="json"){const V=_.data,k=O(ot(V),n.jsonChunkSize??5e5);for(const j of k)F.append("__superform_json",j);Object.keys(V).forEach(j=>{typeof F.get(j)=="string"&&F.delete(j)})}if(!n.SPA&&!F.has("__superform_id")){const V=E(v);V!==void 0&&F.set("__superform_id",V)}}}function O(D,_){const F=Math.ceil(D.length/_),V=new Array(F);for(let k=0,j=0;k<F;++k,j+=_)V[k]=D.substring(j,j+_);return V}async function Z(D){const _=D.result.type?D.result:{type:"error",status:500,error:D.result};W=null;let F=!1;const V={result:_,formEl:e,cancel:()=>F=!0};for(const k of h.onResult)await k(V);if(!F){if((_.type==="success"||_.type=="failure")&&_.data){const k=R(_.data);if(!k.length)throw new H("No form data returned from ActionResult. Make sure you return { form } in the form actions.");for(const j of k){if(j.id!==E(v))continue;const le={form:j,formEl:e,cancel:()=>F=!0};for(const te of h.onUpdate)await te(le);!F&&n.customValidity&&Mt(e,le.form.errors)}}if(!F){if(_.type!=="error")_.type==="success"&&n.invalidateAll&&await Ze(),n.applyAction?await he(_):await o(_);else{if(n.applyAction)if(n.onError=="apply")await he(_);else{const k={type:"failure",status:Math.floor(_.status||500),data:_};await he(k)}if(n.onError!=="apply"){const k={result:_,message:l};for(const j of h.onError)j!=="apply"&&(j!=Xe||!n.flashMessage?.onError)&&await j(k)}}n.flashMessage&&_.type=="error"&&n.flashMessage.onError&&await n.flashMessage.onError({result:_,message:n.flashMessage.module.getFlash(ue)})}}if(F&&n.flashMessage&&Oe(n),F||_.type!="redirect")q.completed(F);else if(_.type=="redirect")if(new URL(_.location,/^https?:\/\//.test(_.location)?void 0:document.location.origin).pathname==document.location.pathname)setTimeout(()=>{q.completed(!0,!0)},0);else{const k=it.subscribe(j=>{j||(k(),q.completed(F))})}}return Z})}new TextEncoder;const Xe=e=>{console.warn("Unhandled Superform error, use onError event to handle it:",e.result.error)},kt={applyAction:!0,invalidateAll:!0,resetForm:!1,autoFocusOnError:"detect",scrollToError:"smooth",errorSelector:'[aria-invalid="true"],[data-invalid]',selectErrorText:!1,stickyNavbar:void 0,taintedMessage:"Do you want to leave this page? Changes you made may not be saved.",onSubmit:void 0,onResult:void 0,onUpdate:void 0,onUpdated:void 0,onError:Xe,dataType:"form",validators:void 0,defaultValidator:"keep",customValidity:!1,clearOnSubmit:"errors-and-message",delayMs:500,timeoutMs:8e3,multipleSubmits:"prevent",validation:void 0,SPA:void 0,validateMethod:"auto"},me=new WeakMap,re=new WeakMap;function Pt(e){return`Duplicate form id's found: "${e}". Multiple forms will receive the same data. Use the id option to differentiate between them, or if this is intended, set the warnings.duplicateId option to false in superForm to disable this warning. More information: https://superforms.rocks/concepts/multiple-forms`}function Dt(e,t={}){t={...kt,...t},t.SPA&&t.validators===void 0&&console.warn("No validators set for superForm in SPA mode. Add them to the validators option, or set it to false to disable this warning.");let r=t.id;!e||b(e)===!1?(t.warnings?.noValidationAndConstraints!==!1&&console.warn((e?"Form data sent directly to superForm instead of through superValidate. No initial data validation is made. ":"No form data sent to superForm, schema type safety cannot be guaranteed. ")+"Also, no constraints will exist for the form. Set the warnings.noValidationAndConstraints option to false to disable this warning."),e={valid:!1,posted:!1,errors:{},data:e??{},constraints:{}}):r===void 0&&(r=e.id);const a=r,i=E(ue);if(t.warnings?.duplicateId!==!1)if(!me.has(i))me.set(i,new Set([a]));else{const s=me.get(i);s?.has(a)?console.warn(Pt(a)):s?.add(a)}re.has(e)||re.set(e,ee(e));const o=re.get(e);if(typeof o.valid!="boolean")throw new H("A non-validation object was passed to superForm. It should be an object of type SuperValidated, usually returned from superValidate.");i.form,e=ee(o);const n=e,u=B(n.errors),l=B(r),m={taintedMessage:t.taintedMessage,taintedFormState:ee(o.data)};function h(s=8){return Math.random().toString(36).substring(2,s+2)}function v(s){m.taintedFormState=ee(s)}function c(s){return Object.values(s).filter(y=>b(y)!==!1)}function b(s){return!s||typeof s!="object"||!("valid"in s&&"errors"in s&&typeof s.valid=="boolean")?!1:"id"in s&&typeof s.id=="string"?s.id:void 0}function p(){t.taintedMessage=m.taintedMessage,r===void 0&&l.set(h())}function R(s){const d=B(s);return{subscribe:d.subscribe,set:(y,w={})=>(_(y,m.taintedFormState,w.taint??!0),v(y),d.set(ee(y))),update:(y,w={})=>d.update(S=>{const z=y(S);return _(z,m.taintedFormState,w.taint??!0),v(z),z})}}const I=[l.subscribe(s=>r=s)];function T(s){I.push(s)}function Q(){I.forEach(s=>s())}const f=R(n.data);function P(s,d){if(!(!d||typeof d!="object")){if(Array.isArray(d))d.length>0&&P(s,d[0]);else if(!(d instanceof Date))throw new H(`Object found in form field "${s}". Set the dataType option to "json" and add use:enhance to use nested data structures. More information: https://superforms.rocks/concepts/nested-data`)}}async function J(s,d){s.valid&&d&&t.resetForm&&(t.resetForm===!0||t.resetForm())?U(s.message):te(s,d),K.onUpdated.length&&await De();for(const y of K.onUpdated)y({form:s})}function U(s,d,y){const w=ee(o);w.data={...w.data,...d},y!==void 0&&(w.id=y),te(w,!0,s)}const ne=async(s,d)=>{if(s.type=="error")throw new H(`ActionResult of type "${s.type}" cannot be passed to update function.`);if(s.type=="redirect"){t.resetForm&&(t.resetForm===!0||t.resetForm())&&U();return}if(typeof s.data!="object")throw new H("Non-object validation data returned from ActionResult.");const y=c(s.data);if(!y.length)throw new H("No form data returned from ActionResult. Make sure you return { form } in the form actions.");for(const w of y)w.id===r&&await J(w,d??(s.status>=200&&s.status<300))},q=B([]),W=B(n.message),g=B(n.constraints),L=B(!1),A={subscribe:u.subscribe,set:u.set,update:u.update,clear:()=>ke(u,{undefinePath:null,clearFormLevelErrors:!0})},M=B();function O(){return E(M)}function Z(s){if(s===null)throw new H("$tainted store contained null");if(typeof s=="object"){for(const d of Object.values(s))if(Z(d))return!0}return s===!0}async function D(s,d){let y=t.validationMethod==="oninput";if(!y){const w=E(A),S=w?Re(w,s,{modifier:ae=>{if(Me(s,ae))throw new H("Errors can only be added to form fields, not to arrays or objects in the schema. Path: "+ae.path.slice(0,-1));return ae.value}}):void 0;y=!!(S&&S.key in S.parent)}return y?(await Ae(s,t,f,A,M,{taint:d}),!0):!1}async function _(s,d,y){if(y=="ignore")return;let w=ht(s,d);if(typeof y=="object"&&(typeof y.fields=="string"&&(y.fields=[y.fields]),w=y.fields.map(S=>ye(S)),y=!0),q.set(w),w.length&&(y==="untaint-all"?M.set(void 0):M.update(S=>{if(y!==!0&&S){const z=S;w=w.filter(ae=>Re(z,ae)),w.length&&(S||(S={}),$(S,w,void 0))}else y===!0&&(S||(S={}),$(S,w,!0));return S}),!(t.validationMethod=="onblur"||t.validationMethod=="submit-only"))){let S=!1;for(const z of w)S=S||await D(z,y);S||await vt(t,f,A,E(M))}}function F(s,d){M.set(s),v(d)}const V=B(!1),k=B(!1),j=B(!1),le=se(A,s=>s?bt(s):[]);if(t.taintedMessage=void 0,Te(()=>{Q();for(const s of Object.values(K))s.length=0;me.get(i)?.delete(a)}),t.dataType!=="json")for(const[s,d]of Object.entries(n.data))P(s,d);function te(s,d,y){if(d&&F(typeof d=="boolean"?void 0:d,s.data),y=y??s.message,f.set(s.data,{taint:"ignore"}),W.set(y),A.set(s.errors),l.set(s.id),L.set(s.posted),t.flashMessage&&Pe(t)){const w=t.flashMessage.module.getFlash(ue);y&&E(w)===void 0&&w.set(y)}}const K={onSubmit:t.onSubmit?[t.onSubmit]:[],onResult:t.onResult?[t.onResult]:[],onUpdate:t.onUpdate?[t.onUpdate]:[],onUpdated:t.onUpdated?[t.onUpdated]:[],onError:t.onError?[t.onError]:[]};qe(s=>{if(t.taintedMessage&&!E(V)){const d=O();d&&Z(d)&&!window.confirm(t.taintedMessage)&&s.cancel()}}),T(ue.subscribe(async s=>{if(!t.applyAction)return;t.SPA&&await new Promise(y=>setTimeout(y,0));const d=s.status>=200&&s.status<300;if(s.form&&typeof s.form=="object"){const y=s.form;if(y.type=="error")return;const w=c(y);for(const S of w)S.id!==r||re.has(S)||(re.set(S,S),await J(S,d))}else if(s.data&&typeof s.data=="object"){const y=c(s.data);for(const w of y)w.id!==r||re.has(w)||te(w,d)}}));const Ye=Object.fromEntries(Object.keys(o.data).map(s=>[s,{name:s,value:_e(f,s),errors:_e(A,s),constraints:_e(g,s)}]));async function Ge(s,d){return s===void 0?xe(t.validators,E(f),r,E(g),!1):(await Ae(ye(s),t,f,A,M,d)).errors}return{form:f,formId:l,errors:A,message:W,constraints:g,fields:Ye,tainted:M,submitting:se(V,s=>s),delayed:se(k,s=>s),timeout:se(j,s=>s),options:t,capture:function(){return{valid:o.valid,posted:E(L),errors:E(A),data:E(f),constraints:E(g),message:E(W),id:r,tainted:E(M)}},restore:function(s){return te(s,s.tainted??!0)},validate:Ge,enhance:(s,d)=>{if(d){if(d.onError){if(t.onError==="apply")throw new H('options.onError is set to "apply", cannot add any onError events.');if(d.onError==="apply")throw new H('Cannot add "apply" as onError event in use:enhance.');K.onError.push(d.onError)}d.onResult&&K.onResult.push(d.onResult),d.onSubmit&&K.onSubmit.push(d.onSubmit),d.onUpdate&&K.onUpdate.push(d.onUpdate),d.onUpdated&&K.onUpdated.push(d.onUpdated)}return Ft(s,V,k,j,A,ne,t,f,W,p,K,l,g,M,q,c,L)},allErrors:le,posted:L,reset:s=>U(s?.keepMessage?E(W):void 0,s?.data,s?.id)}}export{Ut as E,Ot as i,Dt as s};
//# sourceMappingURL=index.RB1Qc8eZ.js.map
